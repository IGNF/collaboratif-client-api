<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Home</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Home</h1>

    



    


    <h3> </h3>










    




    <section>
        <article><h2>Introduction</h2>
<p>Module permettant d'intéragir avec l'api du collaboratif et de gérer l'authentification
Dépendances axios (http client utilisant les promesses) et crypto-js pour encrypter le mot de passe utilisateur
Si définie, la variable d'environnement SECRET est utilisée pour l'encryptage</p>
<h2>Installation</h2>
<p>npm install http://gitlab.dockerforge.ign.fr/collaboratif/collaboratif-client-api.git</p>
<p>Vous devez autoriser les requêtes CORS vers le domaine .ign.fr et vers l'api d'authentification. Exemple pour cordova, dans le fichier config.xml, ajouter:</p>
<pre class="prettyprint source"><code>&lt;allow-navigation href=&quot;*://*.ign.fr/*&quot; />
&lt;allow-navigation href=&quot;https://iam-ign-qa.cegedim.cloud/*&quot; />
</code></pre>
<h2>Génération documentation:</h2>
<p>./node_modules/.bin/jsdoc -d doc src/ README.md</p>
<h2>Exemple d'utilisation:</h2>
<pre class="prettyprint source"><code>
import {ApiClient} from 'collaboratif-client-api';

//ex pour des routes accessibles sans authentification:
let apiClientUnAuth = new ApiClient(
    'https://espacecollaboratif.ign.fr/gcms/api', // l url de base de l api
);
apiClientUnAuth.getReports().then((reportResponse) => console.log(reportResponse.data)); //affichage des 10 premières alertes publiques

//ex avec authentification
let apiClient = new ApiClient(
    'https://espacecollaboratif.ign.fr/gcms/api', // l url de base de l api
    'https://iam-url/auth/realms/demo/protocol/openid-connect', // l url de base pour l'authentification
    clientId,
    clientSecret
);

apiClient.setCredentials(&quot;moi&quot;, &quot;mon_super_mot_de_passe&quot;);

apiClient.getUser().then((userResponse) => console.log(userResponse.data)); //affichage de mes informations utilisateur

apiClient.getLayers(&quot;mon_id_de_communaute&quot;, {&quot;limit&quot;: 2}).then((layersResponse) => console.log(layersResponse.data[0])) //récupération de 2 couches et affichage de la premiere


</code></pre>
<p>On peut également directement utiliser la route doRequest du client si le raccourci n'est pas défini. (ex: apiClient.doRequest(&quot;/communities&quot;, &quot;get&quot;, null, {&quot;limit&quot;: 2}))</p>
<h2>Et ensuite</h2>
<p>Une validation sur les paramètres existants est effectuée et sur les paramètres obligatoires à fournir dans le body. Il faudrait ajouter de la validation sur tous les paramètres. Par exemple quand il y a une liste de choix, ou valider la syntaxe pour la bbox etc... Ca permettra d'éviter les requêtes inutiles qui vont finir en 400 si la requête est mal formatée.
Toutes les routes ne sont pas encore présentes, il faudra compléter.</p></article>
    </section>






</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="ApiClient.html">ApiClient</a></li><li><a href="AuthClient.html">AuthClient</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.0</a> on Mon Jan 16 2023 13:22:47 GMT+0100 (heure normale d’Europe centrale)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>